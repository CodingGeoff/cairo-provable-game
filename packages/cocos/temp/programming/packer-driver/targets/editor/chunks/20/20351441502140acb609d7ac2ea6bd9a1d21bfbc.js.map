{"version":3,"sources":["file:///Users/ruoyan/Desktop/WorkSpace/LegendOfWarcraftHeroes/assets/script/util/bundle/load.ts"],"names":["load","path","type","assetsBundle","resources","bundleCacheMap","cachMap","get","set","Map","result","Promise","res","err","data","error"],"mappings":";;;;;AAMA;AACO,iBAAeA,IAAf,CAAuBC,IAAvB,EAAsCC,IAAtC,EAAsEC,YAAtE,EAAsH;AACzHA,IAAAA,YAAY,GAAGA,YAAY,IAAIC,SAA/B;AACA,QAAIC,cAAc,GAAGC,OAAO,CAACC,GAAR,CAAYJ,YAAZ,CAArB;AACA,QAAI,CAACE,cAAL,EAAqBC,OAAO,CAACE,GAAR,CAAYL,YAAZ,EAA2BE,cAAc,GAAG,IAAII,GAAJ,EAA5C;AACrB,QAAIC,MAAM,GAAGL,cAAc,CAACE,GAAf,CAAmBN,IAAnB,CAAb;AACA,QAAIS,MAAJ,EAAY,OAAOA,MAAP;AACZ,WAAO,IAAIC,OAAJ,CAAeC,GAAG,IAAI;AACzBT,MAAAA,YAAY,CAACH,IAAb,CAAkBC,IAAlB,EAAyBC,IAAzB,EAAuC,CAACW,GAAD,EAAOC,IAAP,KAAgB;AACnD,YAAID,GAAJ,EAAS;AACL;AAAA;AAAA,8BAAMA,GAAN;AACA,iBAAOD,GAAG,CAAC,IAAD,CAAV;AACH;;AACDP,QAAAA,cAAc,CAACG,GAAf,CAAmBP,IAAnB,EAA0Ba,IAA1B;AACA,eAAOF,GAAG,CAACE,IAAD,CAAV;AACH,OAPD;AAQH,KATM,CAAP;AAUH;;;;;;kBAhBqBd,I;;;;;;;;;AAPCI,MAAAA,S,OAAAA,S;;AACdW,MAAAA,K,iBAAAA,K;;;;;;;;;AAET;AACMT,MAAAA,O,GAAU,IAAIG,GAAJ,E","sourcesContent":["import { AssetManager, resources } from \"cc\";\nimport { error } from \"../out/error\";\n\n// 缓存\nconst cachMap = new Map<AssetManager.Bundle , Map<string , any>>()\n\n// 加载资源\nexport async function load<T>(path: string , type?: new (...a: any[]) => T , assetsBundle?: AssetManager.Bundle): Promise<T> {\n    assetsBundle = assetsBundle || resources\n    let bundleCacheMap = cachMap.get(assetsBundle)\n    if (!bundleCacheMap) cachMap.set(assetsBundle , bundleCacheMap = new Map)\n    let result = bundleCacheMap.get(path)\n    if (result) return result\n    return new Promise<T>(res => {\n        assetsBundle.load(path , type as any , (err , data) => {\n            if (err) {\n                error(err)\n                return res(null)\n            }\n            bundleCacheMap.set(path , data)\n            return res(data as any)\n        })\n    })\n}"]}