{"version":3,"sources":["file:///Users/ruoyan/Desktop/WorkSpace/cairo-provable-game/packages/cocos/assets/script/game/fight/character/CharacterState.ts"],"names":["CharacterState","BasicState","CharacterEnum","EquipmentState","constructor","create","component","meta","id","name","lv","star","hp","maxHp","energy","maxEnergy","attack","defence","speed","pierce","curePercent","hurtPercent","FreeInjuryPercent","critical","block","buff","equipment","strength1","agility1","intelligence1","Energy","BasicHp","strength","BasicAttack","BasicSpeed","agility","Block","intelligence","forEach","ec","addEquipment","OnCreateState","reasonableData","equipmentState","push","AddPropertyToCharacter"],"mappings":"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","sourcesContent":["import { Component } from \"cc\";\nimport { BasicState } from \"../BasicState\";\nimport { CharacterMetaState } from \"./CharacterMetaState\";\nimport { BuffState } from \"../buff/BuffState\";\nimport { CharacterEnum } from \"./CharacterEnum\";\nimport { EquipmentState, EquipmentStateCreate } from \"../equipment/EquipmentState\";\nimport { HolCharacter } from \"../../../prefab/HolCharacter\";\nimport { util } from \"../../../util/util\";\n\nexport type CharacterStateCreate = {\n    // id\n    id: string\n    // uuid\n    uuid?: number\n    // 等级\n    lv: number\n    // 星级\n    star: number\n    // 拥有装备\n    equipment: EquipmentStateCreate[]\n    // 力量\n    strength?: number\n    // 敏捷\n    agility?: number\n    // 智力\n    intelligence?: number\n}\n\nexport class CharacterState extends BasicState<CharacterMetaState> {\n\n    /**\n     * 所属组件\n     * 一般来说是 HolCharacter 对象\n     */\n    component: HolCharacter\n\n    // 名称\n    name: string\n    // 等级\n    lv: number\n    // 角色星级\n    star: number\n    // 所属create\n    create: CharacterStateCreate\n\n    // 生命值\n    hp: number\n    // 最大生命值\n    maxHp: number\n    // 能量值\n    energy: number\n    // 最大能量值\n    maxEnergy: number\n    // 攻击力\n    attack: number\n    // 防御力\n    defence: number\n    // 速度\n    speed: number\n    // 穿透\n    pierce: number\n    // 治疗效率\n    curePercent: number = 1.0\n    // 伤害率\n    hurtPercent: number = 1.0\n    // 免伤率\n    FreeInjuryPercent: number = 0.0\n    // 暴击\n    critical: number\n    // 格挡\n    block: number = 0\n\n    // 所有buff\n    buff: BuffState[] = []\n    // 所有装备\n    equipment: EquipmentState[] = []\n\n    strength1: number = 0\n    agility1: number = 0\n    intelligence1: number = 0\n\n    /** \n     * 构造器\n     * component 是所属组件\n     */\n    constructor(create: CharacterStateCreate , component: HolCharacter) {\n        const meta: CharacterMetaState = CharacterEnum[create.id]\n        super(meta)\n        this.lv = create.lv\n        this.star = create.star\n        this.name = meta.name\n        this.component = component\n        this.create = create\n\n        this.maxEnergy = meta.Energy\n        this.maxHp = meta.BasicHp + create.strength * 200\n        // create.lv * meta.HpGrowth * ((create.star - 1) * 0.15 + 1) * (create.lv / 80 + 0.8)\n        this.attack = meta.BasicAttack + create.strength * 130\n        // create.lv * meta.AttackGrowth * ((create.star - 1) * 0.15 + 1) * (create.lv / 80 + 0.8)\n        this.defence = 0\n        // create.lv * meta.DefenceGrowth * ((create.star - 1) * 0.15 + 1) * (create.lv / 80 + 0.8)\n        this.speed = meta.BasicSpeed + create.agility * 5\n        // create.lv * meta.SpeedGrowth * ((create.star - 1) * 0.15 + 1) * (create.lv / 80 + 0.8)\n        this.pierce = 0\n        // create.lv * meta.PierceGrowth * ((create.star - 1) * 0.15 + 1) * (create.lv / 80 + 0.8)\n        this.critical = 0\n        // meta.Critical\n        this.block = meta.Block\n\n        this.strength1 = create.strength\n        this.agility1 = create.agility\n        this.intelligence1 = create.intelligence\n\n        create.equipment.forEach(ec => this.addEquipment(ec))\n        meta.OnCreateState(this)\n\n        this.hp = this.maxHp\n        this.energy = 30\n    }\n\n    // 合理化数据\n    reasonableData() {\n        if (this.hp > this.maxHp) this.hp = this.maxHp\n        if (this.energy > this.maxEnergy) this.energy = this.maxEnergy\n        if (this.hp < 0) this.hp = 0\n        if (this.energy < 0) this.energy = 0\n    }\n    \n    /** \n     * 添加装备函数\n     * 在构造时调用会将装备所添加的属性加到该对象上\n     */\n    private addEquipment(equipment: EquipmentStateCreate) {\n        const equipmentState = new EquipmentState(equipment , this)\n        this.equipment.push(equipmentState)\n        equipmentState.AddPropertyToCharacter(equipmentState)\n    }\n}"]}