{"version":3,"sources":["file:///Users/ruoyan/Desktop/WorkSpace/LegendOfWarcraftHeroes/assets/script/game/fight_entity/buff/bleed.ts"],"names":["RegisterBuff","BuffMetaState","BleedBuff","id","name","isDeBuff","introduce","buffIcon","GetOnCreate","self","option","state","set","roundReduceBleed","GetOnRoundBegan","roundState","fightMap","hurt","Math","ceil","get","character","hp","isPlayAnimation","component","showString","updateUi"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKSA,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,a,iBAAAA,a;;;;;;;AAIT;2BAOaC,S,WADZ;AAAA;AAAA,wCAAa;AAACC,QAAAA,EAAE,EAAE;AAAL,OAAb,C,gBAAD,MACaD,SADb;AAAA;AAAA,0CAC6C;AAAA;AAAA;AAEzC;AAFyC,eAGzCE,IAHyC,GAG1B,IAH0B;AAAA,eAKzCC,QALyC,GAKrB,IALqB;AAAA,eAOzCC,SAPyC,GAOrB,aAPqB;AAAA,eASzCC,QATyC,GAStB,0CATsB;AAAA;;AAWzCC,QAAAA,WAAW,GAA4D;AACnE,gDAAO,WAAOC,IAAP,EAAwBC,MAAxB,EAAgD;AACnDA,YAAAA,MAAM,GAAGA,MAAM,IAAI,EAAnB;AACAD,YAAAA,IAAI,CAACE,KAAL,CAAWC,GAAX,CAAe,kBAAf,EAAoCF,MAAM,CAACG,gBAAP,IAA2B,CAA/D;AACH,WAHD;AAIH,SAhBwC,CAkBzC;;;AACAC,QAAAA,eAAe,GAAmF;AAC9F,gDAAO,WAAOL,IAAP,EAAwBM,UAAxB,EAAgDC,QAAhD,EAAuE;AAC1E,gBAAMC,IAAI,GAAGC,IAAI,CAACC,IAAL,CAAUV,IAAI,CAACE,KAAL,CAAWS,GAAX,CAAe,kBAAf,KAAsC,CAAhD,CAAb;AACAX,YAAAA,IAAI,CAACY,SAAL,CAAeC,EAAf,IAAqBL,IAArB,CAF0E,CAG1E;;AACA,gBAAID,QAAQ,CAACO,eAAb,EAA8B;AAC1B,oBAAMd,IAAI,CAACY,SAAL,CAAeG,SAAf,CAAyBC,UAAzB,CAAoC,OAAO,GAAP,GAAaR,IAAjD,CAAN;AACA,oBAAMR,IAAI,CAACY,SAAL,CAAeG,SAAf,CAAyBE,QAAzB,EAAN;AACH;AACJ,WARD;AASH;;AA7BwC,O","sourcesContent":["import { HolCharacter } from \"../../../prefab/HolCharacter\";\nimport { FightMap } from \"../../../scenes/Fight/Canvas/FightMap\";\nimport { ActionState } from \"../../fight/ActionState\";\nimport { BasicState } from \"../../fight/BasicState\";\nimport { RoundState } from \"../../fight/RoundState\";\nimport { RegisterBuff } from \"../../fight/buff/BuffEnum\";\nimport { BuffMetaState } from \"../../fight/buff/BuffMetaState\";\nimport { BuffState } from \"../../fight/buff/BuffState\";\nimport { CharacterState } from \"../../fight/character/CharacterState\";\n\n// 流血的配置\nexport type BleedOption = {\n    // 每回合扣多少血\n    roundReduceBleed?: number\n}\n\n@RegisterBuff({id: \"bleed\"})\nexport class BleedBuff extends BuffMetaState {\n    \n    // 眩晕buff\n    name: string = \"流血\"\n\n    isDeBuff: boolean = true\n\n    introduce: string = \"每回合开始造成指定伤害\"\n\n    buffIcon: string = \"game/fight_entity/buff/bleed/spriteFrame\"\n\n    GetOnCreate(): (self: BuffState, option: BleedOption) => Promise<void> {\n        return async (self: BuffState, option: BleedOption) => {\n            option = option || {}\n            self.state.set(\"roundReduceBleed\" , option.roundReduceBleed || 0)\n        }\n    }\n\n    // 回合开始扣血\n    GetOnRoundBegan(): (self: BuffState, roundState: RoundState, fightMap: FightMap) => Promise<void> {\n        return async (self: BuffState, roundState: RoundState, fightMap: FightMap) => {\n            const hurt = Math.ceil(self.state.get(\"roundReduceBleed\") || 1)\n            self.character.hp -= hurt\n            // 输出扣血动画\n            if (fightMap.isPlayAnimation) {\n                await self.character.component.showString(\"流血\" + \"-\" + hurt)\n                await self.character.component.updateUi()\n            }\n        }\n    }\n}"]}